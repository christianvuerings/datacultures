<div ng-controller="GalleryItemController">
  <div class="dc-full-header">
    <a href="/gallery" class="dc-full-back-link">&#8592; Back to Gallery</a>
  </div>

  <div class="dc-full-container">
    <div ng-if="currentItem.type === 'image'">
      <img class="dc-full-image" ng-src="{{currentItem.image_url}}">
    </div>
    <div ng-if="currentItem.type === 'video'" class="dc-videowrapper">
      <iframe ng-src="{{currentItem.videoUrl}}" width="500" height="375" frameborder="0" allowfullscreen></iframe>
    </div>
  </div>

  <div class="dc-comments" ng-controller="GalleryCommentController">
    <h2>Comments ({{currentItem.comments.length}})</h2>

    <form ng-submit="addComment()" name="dc_comments_form">
      <textarea ng-model="comment.input" required placeholder="Enter your comment..."></textarea>
      <div>
        <button type="submit" class="btn btn-info" ng-disabled="dc_comments_form.$invalid">Submit</button>
      </div>
    </form>

    <ul class="dc-comments-list" ng-if="currentItem.comments.length">
      <li ng-repeat="comment in currentItem.comments">
        <div ng-if="!comment.editMode">
          <div class="dc-comments-list-comment" ng-bind-html="comment.comment | linky"></div>
          <div class="dc-comments-list-comment-info">
            by {{comment.author.name}}
            <span ng-if="comment.author.canvas_user_id === api.user.me.canvas_user_id"> | <button type="button" ng-click="enterEditMode(comment)" class="btn btn-info">Edit</button></span>
          </div>
        </div>
        <div ng-if="comment.editMode">
          <form ng-submit="updateComment(editComment)" name="dc_comments_form_{{comment.$$index}}">
            <textarea ng-model="editComment.comment" required placeholder="Enter your comment..."></textarea>
            <div>
              <button type="button" class="btn btn-info" ng-click="comment.editMode = false">Cancel</button>
              <button type="submit" class="btn btn-info" ng-disabled="dc_comments_form_{{comment.$$index}}.$invalid">Submit</button>
            </div>
          </form>
        </div>
      </li>
    </ul>
  </div>
</div>
